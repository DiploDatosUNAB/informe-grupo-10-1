---
title: "TP1-grupo10"
author: "Andrea Ariza- Nestor Martinez"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Cargar los paquetes necesarios acá

library(presentes)
library(dplyr)
library(readr)
library(tidyr)
library(ggplot2)
library(stringr)
victimas_accionar_represivo_ilegal <- presentes::victimas_accionar_represivo_ilegal
centros_clandestinos_detencion <- presentes::centros_clandestinos_detencion


```


## Introducción

En este trabajo práctico vamos a analizar los datos titulados Desaparecidos. Este conjunto de datos facilita el acceso a los registros estatales de las personas desaparecidas en la última dictadura militar argentina desarrollada entre el 24 de marzo de 1976 y el 10 de diciembre de 1983. 
Los datos fueron obtenidos por Diego Kozlowski. Según la información presente en el repositorio, provienen del Registro Único de Víctimas del Terrorismo de Estado (RUVTE) dependiente de la Secretaría de Derechos Humanos y Pluralismo Cultural del Ministerio de Justicia y Derechos Humanos de la Nación, creado por Resolución 1261/2014 de dicho Ministerio (https://datos.gob.ar/dataset/justicia-registro-unificado-victimas-terrorismo-estado--ruvte-). En segundo lugar, el Monumento a las Víctimas del Terrorismo de Estado, realizado por el Consejo de Gestión del Parque de la Memoria y del Monumento a las Víctimas del Terrorismo de Estado, creado por la ley 3078 de la Ciudad de Buenos Aires (http://basededatos.parquedelamemoria.org.ar/). Ambos registros recogen información de víctimas asesinadas o detenidas/desaparecidas aún antes de la fecha del inicio formal del golpe de estado militar.
La base de datos fue publicada el 5 de noviembre de 2019.

La base de datos cuenta con cinco conjunto de datos:
1) Apodos
2) Centros clandestinos de detención
3) Parque de la Memoria
4) Victimas del accionar represivo ilegal
5) Victimas del accionar represeivo ilegal sin denuncia formal. 

De las cinco bases de datos, seleccionaremos en principio la base titulada "victimas del accionar represivo ilegal".Esta base de datos cuenta con un total de 20 columnas con 8753 entradas. En las columnas podemos encontrar los siguientes temas o variables: id_unico_rouvte, anio_denuncia, tipificacion_ruvte, apellido_paterno_nombres, apellido_materno, apellido_casada, edad_al_momento_del_hecho, documentos, anio_nacimiento, provincia_nacimiento, pais_nacimiento, nacionalidad, embarazo, fecha_detencion_secuestro, lugar_detencion_secuestro,fecha_asesinato_o_hallazgos_de_restos, lugar_asesinato_o_hallazgos_de_restos, fotografia, provincia_nacimiento_indec_id y pais_nacimiento_indec_id. 

En la primera exploración de los datos nos concetraremos sobre todo en algunas columnas tales como la nacionalidad, el lugar de detención, el año de denuncia, el tipo de delito del que fue víctima, la provincia de origen. 

## Exploración de los datos

vamos a trabajar con la tabla victimas_accionar_represivo_ilegal

Primero vamos filtrando para acercarnos a los datos. 

Primero contamos cuantas victimas hay de nacionalidad argentina y menores a 30 años. 
```{r}

victimas_accionar_represivo_ilegal|>
  count(nacionalidad == "ARGENTINA", edad_al_momento_del_hecho <=30)


```

```{r}
ciudades = c("BUENOS AIRES", "CORDOBA", "MENDOZA", "SANTA FE", "CAPITAL FEDERAL")
victimas_accionar_represivo_ilegal|>
  filter(lugar_detencion_secuestro %in% ciudades, edad_al_momento_del_hecho<=30)|>
  count()
```

Vamos a calcular la cantidad de personas secuestradas en grandes centros urbanos. 

```{r}
ciudades = c("BUENOS AIRES", "CORDOBA", "MENDOZA", "SANTA FE", "CAPITAL FEDERAL")
victimas_accionar_represivo_ilegal|>
  filter(grepl("BUENOS AIRES|CORDOBA|MENDOZA|SANTA FE|CAPITAL FEDERAL", lugar_detencion_secuestro))|>
  summarise(n=n())
  
```

```{r}
data_poblacion <- data_frame(detenidos_centros_urbanos=6316, detenidos_jovenes = 1353, desaparicion_forzada =6054, embarazada= 284) 
```



Vamos a indagar sobre la cantidad de desaparecidos según la provincia de nacimiento en valores absolutos y porcentajes. 
```{r}

victimas_accionar_represivo_ilegal|>
 group_by(provincia_nacimiento)|>
  summarise(n=n())|>
  mutate(porcentaje = n/sum(n)*100)

```

Ahora vamos a presentar estos datos en un gráfico.

```{r}
victimas_accionar_represivo_ilegal|>
 group_by(provincia_nacimiento)|>
  summarise(n=n())|>
  ggplot(aes(n,provincia_nacimiento))+
  geom_bar(stat = "identity")
  
```


Vamos a contar según el motivo de la denuncia formal. 
```{r}
# Cödigo de R acá 

victimas_accionar_represivo_ilegal|>
  group_by(tipificacion_ruvte)|>
  count()|>
  arrange(desc(n))

```



Vamos a calcular cuantas victimas desaparecidas estaban embarazadas al momento de su desaparición. 
```{r}
victimas_accionar_represivo_ilegal|>
  filter(embarazo == "EMBARAZADA")|>
  count()
```



Ahora vamos a filtrar cuantos restos de desaparecidos fueron hallados. 

pongo !is.na para contar lo que no son na.
```{r}
victimas_accionar_represivo_ilegal|>
  filter(!is.na(fecha_asesinato_o_hallazgo_de_restos))|>
  count()

```



Promedio de los años de denuncia

```{r}
victimas_accionar_represivo_ilegal|>
  summarise(mean(anio_denuncia))

```

```{r}

#col <- suppressWarnings(as.integer(gsub('[a-zA-Z]', '', victimas_accionar_represivo_ilegal$edad_al_momento_del_hecho)))
#summarise(col)
```





## Hipótesis

Como primera hipótesis exploratoria, sostenemos que la mayoría de las victimas del accionar represivo ilegal eran de nacionalidad argentina, nacieron en grandes centros urbanos tales como Buenos Aires y Capital Federal, eran en su mayoría jóvenes menores de 30 años al momento de la detención. En segundo lugar, también sostenemos que la mayoría fue victima de desaparición forzada y que menos de la mitad de las víctimas denunciadas como desaparecidas fueron halladas.  


##Modificación de hipótesis y agregado de nuevos datos

Luego de las primeras observaciones, vamos a empezar a explorar nuevos datos para incorporar al análisis. Por eso mismo vamos a incorporar los datos del censo de 1970 realizado en la República Argentina. 
La hipótesis es que la tasa de desaparecidos
 


```{r}
centros_clandestinos_detencion|>
  group_by(lugar_emplazamiento_propiedad)|>
  summarise(n=n())


```

